{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/why-should-i-write-good-commit-messages/","result":{"data":{"site":{"siteMetadata":{"title":"Ankit Muchhala"}},"markdownRemark":{"id":"6896053d-8f71-531c-a454-7d57291eee19","excerpt":"As a fresh graduate, I was excited at the prospect of writing code for a product used by millions of users. I could not wait send my first PR and get it merged‚Ä¶","html":"<p>As a fresh graduate, I was excited at the prospect of writing code for a product used by millions of users. I could not wait send my first PR and get it merged. Little did I know that the first comments I would receive were not about my code but about my commit messages and how they need to be better.</p>\n<p>The young me thought, ‚ÄúWhy is that important? Who cares about messages? It is the code which matters.‚Äù Two years later, after working on multiple projects, reviewing countless PRs and going through a plethora of public packages, I realize just how wrong I was. Over the course of this article, I would like to describe various scenarios which made me appreciate the importance of writing good commit messages.</p>\n<p>There are a lot of good <a href=\"https://chris.beams.io/posts/git-commit/\">articles and blogposts</a> about how to write commit messages with a list of dos and don‚Äôts. Here, I my focus is on why you should do that.</p>\n<h2>1. Production Issues</h2>\n<blockquote>\n<p>Tom, Sr. Software Engineer</p>\n</blockquote>\n<p><em>Saturday, 2.31 AM ‚Äî phone ringing.</em></p>\n<p>Tom answers his phone and finds out that paid users are unable to login and cannot do anything. A chill goes up his spine. At the back of his mind, he knew he shouldn‚Äôt have deployed on a Friday. Yet, he did and there it is.</p>\n<p>He opens his laptop and checks for server alarms ‚Äî Elevated server errors. To find out what caused this, he opened the server error logs and finds out</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">TypeError: Cannot read property ‚Äúid‚Äù of undefined\n25:13 /api/controllers/LoginController.js\n192:17 ‚Ä¶</code></pre></div>\n<p>‚ÄúAha!‚Äù, he exclaims. He unleashes his weapon of choice ‚Äî git.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> blame api/controllers/LoginController.js</code></pre></div>\n<p>And there it is</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...\nf4f78b31 25) if (user.team.id &gt; 1)\nf4f78b31 26)     return teamLogin();\nf4f78b31 26) else\nf4f78b31 27)     return userLogin();\n...</code></pre></div>\n<p>The bug was right there. Unsafe access for the property id. What if a user does not belong to a team? The <code class=\"language-text\">team</code> property will not exist. So all non-team users are not be able to login.</p>\n<p>To fix this simply replace <em>Line 25</em> with <code class=\"language-text\">user.team</code> &#x26;&#x26; <code class=\"language-text\">user.team.id</code>. Easy! Right?</p>\n<p>Not so fast. What about team with ID <code class=\"language-text\">1</code>? Why are team login and user login different? Why was this change made? Is team ID <code class=\"language-text\">0</code> possible? To better understand the problem, Tom decided to dig further.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git show f4f78b31\n\ncommit f4f78b319c308600eab015a5d6529add21660dc1\nAuthor: Jerry\nDate: Fri Mar 13 10:12:29 2019 +0330\n\n   update login flow         &lt;- üò©üò©üò©üò©\n...</code></pre></div>\n<p>Here is the problem ‚Äî The commit message is vague and does not tell Tom anything more than the actual code diff. He already knows that the login flow was updated. He is looking for more information to <em>help him understand</em> the code change. A better commit message could be:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Create a new login page for team users\n\nWe want to capture team names in the login flow for paid users. This commit shows the new login page for users with a valid team ID.</code></pre></div>\n<p>This commit messages conveys a lot more information about why the change was made? Tom also knows who this change is meant for. This, combined with inline comments, will help him make a much more informed decision.</p>\n<h2>2. Understanding why</h2>\n<blockquote>\n<p>Calvin, Intern</p>\n</blockquote>\n<p><em>Monday, 8.36 AM</em></p>\n<p>Calvin has been assigned a getting-started issue for a Google Maps-like project. His task is to add a configuration for grocery stores. He is to use this opportunity to familiarize himself with the codebase.</p>\n<p>He starts off with <code class=\"language-text\">README.md</code> and <code class=\"language-text\">IMPLEMENTATION.md</code> files to get an overview of the project. After digging around for a while he figures out that the changes are to me made in <code class=\"language-text\">config/maps/elements.js</code>. He has to add a JSON configuration for the key <code class=\"language-text\">grocery-store</code>. Interestingly, he comes across this piece of code</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">if (type === &#39;hospital&#39; || type === &#39;pharmacy&#39;) {\n    config = getConfigFromAPI();\n}</code></pre></div>\n<p>‚ÄúWhy is there a special handling for hospitals and pharmacies? Do I need add special handling for grocery stores?‚Äù, he thinks. He looks at the commit message.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">commit f4f78b319c308600eab015a5d6529add21660dc1\nAuthor: Hobbes\nDate: Fri Mar 11 10:10:21 2018 +0530\n\nadd safe checks in element config    &lt;- ü§î\n...</code></pre></div>\n<p>While this message does tell you that the condition is a safe check, it still does not give you the full picture. Like previous section, it does not tell you <em>why</em> the change was made. A better commit message could be</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">fetch map element config from API for emergency buildings\nto avoid stale information</code></pre></div>\n<p>This clearly conveys the purpose of the code change and provides sufficient information for the reader to make a decision. Calvin can infer that special handling is only for emergency buildings and is not required for a grocery store.</p>\n<p>Here, a good commit message helped a new developer understand parts of the codebase without asking anyone for help. In this respect, commit messages are a second string of documentation for your code.</p>\n<h2>3. Reviewing code</h2>\n<blockquote>\n<p>Wilma, Project Lead</p>\n</blockquote>\n<p><em>Friday, 3.04 PM</em></p>\n<p>Fred has requested a code a review from Wilma for a major change in the team admin view. Wilma pulls the branch on her machine and tests out the changes ‚Äî they seem to be working. She starts by checking diff stats between the branch (<code class=\"language-text\">feature/admin-updates</code>) and <code class=\"language-text\">develop</code> (destination).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git diff feature/admin-updates develop --stats\n\n...\n\n45 files changed, 4085 insertions(+), 590 deletions(-)  &lt;- üò±</code></pre></div>\n<p>The diff shows a lot of code changes including a bunch of new backend APIs, utilities, data flow changes and UI changes. She looks at commit logs to find out if it all these changes are organized properly.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git log --oneline develop..feature/admin-updates\n\ncommit f4f78b319c308600eab015a5d6529add21660dc1\nAuthor: Fred\nDate: Fri Jun 11 2018 12:35:23 +0000\n\nadmin view updates                     &lt;- üòëüòëüòë</code></pre></div>\n<p>Wilma leaves the following review:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">The changes you made seem to be working fine based on a cursory test. However, there are way too many code changes (~4000 lines) in a single commit. This makes it very difficult to review. It might also cause certain issues to be overlooked just by the sheer size of it.\n\nYou can (and should) split your code into logically independent commits. Example -\n- add API endpoints and tests for billing changes in admin view\n- add utilities to validate billing roles for a user\n- separate billing and team management sections in team settings\n- update UI in team settings view to be design system 3.2 compliant</code></pre></div>\n<p>Notice that the focus is on breaking down a big change into smaller chunks, identified by a proper commit message. This allows for more effective code reviews and reduces the chances of overlooking errors.</p>\n<p>By providing smaller commits with proper messages you are conveying your mental model of the solution to the reviewer. This reduces friction and ensures that the developer and reviewer are on the same page.</p>\n<h2>4. Changelog</h2>\n<blockquote>\n<p>Daphne, Engineering Manager</p>\n</blockquote>\n<p>A bugfix release (<code class=\"language-text\">4.1.1</code>) went out yesterday. Daphne wants to know which bugs were fixed and what kind of unplanned code changes were made. She pulls the latest <code class=\"language-text\">master</code> and runs the following command</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git log --oneline v4.1.0..v4.1.1\n\nc1c29526 Upgrade version to v4.1.1\ne7f05736 Fix issue #342               &lt;- #342 of which project?\ne8ad9e21 address comments             &lt;- What comments?\ne3d84047 fix lint tests               &lt;- Where? What for?\nfc6b65de login button bugfix          &lt;- What was the bug?</code></pre></div>\n<p>These commit messages barely convey what was there in the release. They indicate that a login bug was fixed and issue #342 was resolved. But what were these issues and how were they fixed?</p>\n<p>Also, there are also stray commits like <code class=\"language-text\">address comments</code> and <code class=\"language-text\">fix lint tests</code>. These commits are not independent and do not provide any additional value. Instead, they should be squashed with commits they are modifying.</p>\n<p>Following shows one variant of detailed commit messages which would help Daphne better understand the changes in the version</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">e1b29221 Upgrade version to v4.1.1\ne8ad9e33 [GH-342] Fixed issue where header image was not visible in Safari and Internet Explorer\nac6b15ae Fixed an issue where login button was disabled for users on the enterprise plan\n   - added e2e tests for this flow\n   - added analytics events for login failure</code></pre></div>\n<p>These messages clearly explain the changes and also get rid of unnecessary messages. Anyone going through this can easily obtain an overview of the changes in a specific version. This comes in extremely handy while developing public packages ‚Äî your consumers know exactly what was changed.</p>\n<hr>\n<p>Over time, I have come to think of commit messages as little sticky notes associated with my code which provide readers with much needed context. The next time they look at my code and scream ‚ÄúWhy?‚Äù, in disbelief, I hope my commit message can placate them.</p>","frontmatter":{"title":"Why should I write good commit messages?","date":"July 05, 2019","description":"People recommend writing good git commit messages without explaining \"why\". This article provides real-world scenarios which showcase their importance."}},"previous":{"fields":{"slug":"/building-highly-customizable-react-components/"},"frontmatter":{"title":"Building highly customizable React components"}},"next":{"fields":{"slug":"/ui-testing-in-postman/"},"frontmatter":{"title":"UI Testing with Postman"}}},"pageContext":{"id":"6896053d-8f71-531c-a454-7d57291eee19","previousPostId":"c5d8d9dc-9090-5c4b-b3c3-8dc3008f65a4","nextPostId":"fb4676b4-0680-5051-9f55-21ff56eba878"}},"staticQueryHashes":["2841359383","3257411868"]}