{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/web-scraping-with-python/","result":{"data":{"site":{"siteMetadata":{"title":"Ankit Muchhala"}},"markdownRemark":{"id":"1ff2ee71-7f2f-5e8e-8406-333842e8938a","excerpt":"Scraping the web using python is very easy. There are a lot of libraries available which bootstrap a lot of things for you. This post  and  to scrape a…","html":"<p>Scraping the web using python is very easy. There are a lot of libraries available which bootstrap a lot of things for you. This post <code class=\"language-text\">requests</code> and <code class=\"language-text\">BeautifulSoup</code> to scrape a university email client (POP is disabled).</p>\n<h3>Basics</h3>\n<p>To get started, we need to understand how the internet works. What happens when you type in google.com in your browser?</p>\n<p>Imagine the internet as a huge wire connecting your computer (client) to another computer (server) sitting some place far away. So to get a website, you have to first ask the server to give you the website. The way client does this is through something called as requests. As the name suggests, it requests the server for something. As soon as the server gets a request it responds with a message.</p>\n<p>There are various types of requests - GET, POST, PUT, DELETE and so on. Each one of them has a specific function. The first request is always a GET request. This asks the server to send the the webpage. The POST request sends some data from the client to the server. We will worry about these two types of requests right now.</p>\n<p>Response: The natural thing for a server to do, when it gets a request is to respond. This response contains headers and data. Headers are extra information needed for other functionalities. It has things like status code, cookies, etc. You can read up more on them to get a detailed idea.</p>\n<p>For our use we just need to know that server responds to a request with data, if it has any. Otherwise it responds with an error. The type of the error is indicated in the status code.</p>\n<h3>Authentication</h3>\n<p>The idea was to scrape university email client and obtain all the email. It is simply one GET request to obtain the login page. Login to any server is usually a POST request with your login credentials. In python, you can use <code class=\"language-text\">requests</code> library to do this.</p>\n<p><code class=\"language-text\">getLoginScreen = requests.get(&#39;https://webmail.daiict.ac.in&#39;)</code></p>\n<p><code class=\"language-text\">loginRequest = requests.post(&#39;https://webmail.daiict.ac.in/zimbra/&#39;, data={&#39;loginOp&#39;:&#39;login&#39;,&#39;username&#39;: username,&#39;password&#39;:password, &#39;client&#39;: &#39;preferred&#39;})</code></p>\n<h4>Cookies</h4>\n<p>Many login mechanism use cookies or sessions to authenticate users for a particular period of time. To incorporate this, you would have to set headers and send the cookie data as well. This is where requests library comes to your rescue. It has pre-built sessions which saves you the time of sending cookie data. All you have to do is to create a session and use it to login.</p>\n<p><code class=\"language-text\">session = requests.Session()</code></p>\n<p><code class=\"language-text\">getLoginScreen = session.get ..</code></p>\n<p><code class=\"language-text\">loginRequest = session.post( ..</code></p>\n<p>Now the inbox is one GET request away.</p>\n<p><code class=\"language-text\">inbox = session.get(&#39;https://webmail.daiict.ac.in/zimbra/h/search?mesg=welcome&amp;initial=true&amp;app=&#39;)</code></p>\n<p>The <code class=\"language-text\">inbox</code> variable has the HTML of your inbox. We need to process it to get useful information. We use <code class=\"language-text\">BeautifulSoup</code> for this.</p>\n<h3>BeautifulSoup</h3>\n<p>BeautifulSoup library is beautiful. It takes in HTML code and parses it into python datastructures. Let’s not worry about how BeautifulSoup implements it.</p>\n<p><code class=\"language-text\">from bs4 import BeautifulSoup</code></p>\n<p><code class=\"language-text\">soup = BeautifulSoup(inbox.text, &#39;html.parser&#39;)</code></p>\n<p>You can do a lot things with the variable <code class=\"language-text\">soup</code> - find element by id, prettify, sibling, parent and so on. The functions on <code class=\"language-text\">soup</code> allow you to navigate through the DOM tree. Go through the documentation to know more about these functions.</p>\n<p>Note: While printing from python, you may encounter encoding error. You just have to encode the text into utf-8 before printing. Use <code class=\"language-text\">string.encode(&#39;utf-8&#39;)</code>.</p>\n<h3>Using Regex to find useful information</h3>\n<p>After you got the information you need from BeautifulSoup, how do find the data you need? Use regular expressions (Regex). The python library is <code class=\"language-text\">re</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">for i in titles:\n    title = re.sub(&#39;[\\W_]+&#39;, &#39;&#39;, i)\n        if title.find(section) &gt; 0:\n            print &#39;You have an article: %s&#39; % (i)</code></pre></div>\n<p>The above snippet, navigates thorugh the titles of all emails.</p>\n<p><code class=\"language-text\">title = re.sub(&#39;[\\W_]+&#39;, &#39;&#39;, i)</code> removes all non-alphanumeric characters and whitespaces from the titles.</p>\n<p>The script I wrote was for the college magazine editors, who had to navigate through all the emails to find a new article submitted to their respective section. So all I had to do was to find their section in the title string. If it is there, then prompt.</p>\n<p>You can find the source code here:</p>","frontmatter":{"title":"Web scraping with Python","date":"July 20, 2015","description":"Scraping the web using python is very easy. There are a lot of libraries available which bootstrap a lot of things for you. This post  uses requests and BeautifulSoup to scrape a university email client (POP is disabled)."}},"previous":null,"next":{"fields":{"slug":"/brahmastra-called-materialize/"},"frontmatter":{"title":"The Brahmastra called Materialize"}}},"pageContext":{"id":"1ff2ee71-7f2f-5e8e-8406-333842e8938a","previousPostId":null,"nextPostId":"d98bafe4-ab4b-538a-802c-fc9712eebb9c"}},"staticQueryHashes":["2841359383","3257411868"]}